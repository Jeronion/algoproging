## Михаил Густокашин. Бинарный поиск

### 1. Бинарный поиск в упорядоченных массивах

Под упорядоченным массивом будем понимать массив, упорядоченный по неубыванию, то есть  
`a[1] ≤ a[2] ≤ … ≤ a[N]`.

У нас имеется заданная своими границами область поиска. Мы выбираем её середину и, если искомый элемент меньше, чем средний, то поиск осуществляется в левой части, иначе — в правой. Действительно, если искомый элемент меньше среднего, то он меньше всех элементов, которые находятся правее среднего, а значит, их сразу можно исключить из рассмотрения. Аналогично для случая, когда искомый элемент больше среднего.

Код, осуществляющий бинарный поиск в упорядоченном массиве, выглядит так:

```python
left, right = 0, len(array) - 1
while left <= right:
	mid = (left + right) // 2
	if array[mid] < x:
		right = mid - eps
	elif array[mid] > x:
		left = mid + eps
	else:
		print(mid)
```

Перед выполнением этого кода следует присвоить переменным `l` и `r` значения `0` и `n − 1` соответственно. В случае если элемент не найден, программа выводит `-1`.

Сложность алгоритма бинарного поиска составляет **O(log N)**, где `N` — количество элементов в массиве.

---

### 2. Бинарный поиск для монотонных функций

Бинарный поиск может использоваться не только для поиска элементов в массиве, но и для поиска корней уравнений и значений монотонных (возрастающих или убывающих) функций.

Напомним, что функция называется возрастающей, если  
∀x₁, x₂ : x₁ > x₂ ⇒ f(x₁) > f(x₂).

Так же как и в массиве, мы можем исключить из рассмотрения половину текущей области, если нам заранее известно, что там не существует решения. Если же функция не монотонна, пользоваться бинарным поиском нельзя, так как он может выдавать неправильный ответ или находить не все решения.

#### Пример: поиск кубического корня

Кубическим корнем из числа `x` (обозначается ∛x) называется такое число `y`, что `y³ = x`.

**Задача:** для данного вещественного числа `x (x ≥ 1)` найти кубический корень с точностью не менее 5 знаков после точки.

Функция при `x ≥ 1` ограничена сверху числом `x`, а снизу — единицей. Таким образом:

- нижняя граница: `1`
    
- верхняя граница: `x`
    

Делим текущий отрезок пополам, возводим середину в куб и:

- если куб больше `x`, уменьшаем верхнюю границу;
    
- иначе увеличиваем нижнюю.
    

Код:

```python
eps = 10 ** (-11)
x = 20
left, right = 0, x
while abs(left - right) > eps:
	mid = (left + right) / 2
	if mid < x:
		left = mid
	elif mid > x:
		right = mid
print(left)
```

Для использования функции `fabs` необходимо подключить библиотеку `math.h`.

---

### 3. Бинарный поиск по ответу

Во многих задачах требуется вывести некоторое число, при этом легко проверить, больше оно нужного значения или меньше, хотя вычисление самого ответа может быть трудоёмким.

В таком случае можно выбрать:

- число, заведомо меньшее ответа;
    
- число, заведомо большее ответа,
    

и искать правильное решение бинарным поиском.
Однако в половине случаев решение бинарным поиском по ответу можно заменить на формульное решение.