
Теорема Мастера — это инструмент для решения рекуррентных соотношений, возникающих при анализе алгоритмов «разделяй и властвуй». Теорема позволяет определить **асимптотические оценки** $T(n)$ с использованием стандартных обозначений $Θ, O, Ω$.

Рассмотрим рекурренцию вида:

$$
T(n) = aT\left(\frac{n}{b}\right) + f(n)
$$

где:

* $n$ — размер задачи
* $a \ge 1$ — количество подзадач
* $n/b$ — размер каждой подзадачи $(b > 1)$
* $f(n)$ — затраты на работу вне рекурсивных вызовов (разделение задачи и объединение результатов)

---

## Три случая теоремы Мастера

Для рекурренции $T(n) = aT(n/b) + f(n)$, где $a \ge 1$ и $b > 1$:

1. **Случай 1:**
   Если $f(n) = O\big(n^{\log_b a - \epsilon}\big)$ для некоторой константы $\epsilon > 0$, то
   $$
   T(n) = Θ(n^{\log_b a})
   $$

2. **Случай 2:**
   Если $f(n) = Θ\big(n^{\log_b a} \log^k n\big)$ для некоторой константы $k \ge 0$, то
   $$
   T(n) = Θ\big(n^{\log_b a} \log^{k+1} n\big)
   $$

3. **Случай 3:**
   Если $f(n) = Ω\big(n^{\log_b a + \epsilon}\big)$ для некоторой константы $\epsilon > 0$, и если
   $$
   a f\left(\frac{n}{b}\right) \le c f(n)
   $$
   для некоторой константы $c < 1$, то
   $$
   T(n) = Θ(f(n))
   $$

Иными словами:

* Если $f(n) = O(n^c)$ и $c < \log_b a$, то $T(n)$ = $Θ(n^{\log_b a})$
* Если $f(n) = Θ(n^c)$ и $c = \log_b a$ то $T(n) = Θ(n^c \log n)$
* Если $f(n) = Ω(n^c)$ и $c > \log_b a$, то $T(n) = Θ(f(n))$

---

## Структура рекурсии Divide and Conquer

```python
function f(input x of size n):
    if n < k:
        solve x directly
    else:
        divide x into a subproblems of size n/b
        recursively solve each subproblem
        combine results
```

В этой структуре:

* Задача делится на (a) подзадач
* Размер каждой подзадачи — (n/b)
* Работа по делению и объединению представлена функцией (f(n))

Время выполнения выражается как:

$$
T(n) = aT(n/b) + f(n)
$$

---

## Когда теорема Мастера не применяется

Теорема Мастера **не применима**, если:

* $T(n)$ не монотонна например, $T(n) = \sin(n)$
* $f(n)$ не является многочленом или не имеет требуемой формы например, $T(n) = 2T(n/2) + 2^n$

---

## Примеры

**Пример 1: Бинарный поиск**

$$
T(n) = T(n/2) + O(1)
$$

* $a=1, b=2, k=0$
* $a = b^k \Rightarrow$ Случай 2
  $$
  T(n) = Θ(\log n)
  $$

**Пример 2: Merge Sort**

$$
T(n) = 2 T(n/2) + O(n)
$$

* $a=2, b=2, k=1$
* $a = b^k \Rightarrow$ Случай 2
  $$
  T(n) = Θ(n \log n)
  $$

**Пример 3:**

$$
T(n) = 3T(n/2) + n^2
$$

* $a=3, b=2, k=2$
* $a < b^k \Rightarrow$ Случай 3
  $$
  T(n) = Θ(n^2)
  $$

---

## Как работает теорема

Метод основан на **дереве рекурсии**:

* Работа на корне — $f(n)$
* Работа на листьях — $O(n^c)$, где $c = \log_b a$
* Высота дерева — $\log_b n$

**Вывод:**

* Если работа на листьях доминирует → Случай 1
* Если работа на листьях и корне примерно одинакова → Случай 2
* Если работа на корне доминирует → Случай 3

---

## Ключевые моменты

* Теорема Мастера предназначена **для рекуррентных соотношений Divide and Conquer**
* Применяется только к форме $T(n) = aT(n/b) + f(n)$
* Быстро вычисляет **асимптотическую сложность**
* Не все рекурсии решаются с помощью этой теоремы
* Для сложных случаев используют **метод подстановки** или **метод дерева рекурсии**

---

## Продвинутая версия теоремы Мастера

Если рекурсия имеет вид:

$$
T(n) = aT(n/b) + Θ(n^k \log^p n)
$$

где $k \ge 0$, $p \in \mathbb{R}$, то:

* Если $a > b^k$ →
  $$
  T(n) = Θ(n^{\log_b a})
  $$

* Если $a = b^k$:

  * $p > -1 \Rightarrow T(n) = Θ(n^{\log_b a} \log^{p+1} n)$
  * $p = -1 \Rightarrow T(n) = Θ(n^{\log_b a} \log \log n)$
  * $p < -1 \Rightarrow T(n) = Θ(n^{\log_b a})$

* Если $a < b^k$:

  * $p \ge 0 \Rightarrow T(n) = Θ(n^k \log^p n)$
  * $p < 0 \Rightarrow T(n) = Θ(n^k)$

---

### Примеры продвинутой версии

**Пример 1:**

$$
T(n) = 3T(n/2) + \log^2 n
$$

* $a=3, b=2, k=0, p=2$
* $b^k = 1 < a \Rightarrow$ Случай 1
  $$
  T(n) = Θ(n^{\log_2 3})
  $$

**Пример 2:**

$$
T(n) = 2T(n/2) + n \log^2 n
$$

* $a=2, b=2, k=1, p=2$
* $a = b^k \Rightarrow$ Случай 2
  $$
  T(n) = Θ(n \log^3 n)
  $$

**Пример 3:**

$$
T(n) = 2^n T(n/2) + n^n
$$

* Эта рекурсия **не решается** через теорему Мастера, так как функция не имеет требуемой формы